# Next.js App Router

## β… μ•± λΌμ°ν„° κ°λ…

Next.js 13λ¶€ν„° λ„μ…λ **App Router**λ” κΈ°μ΅΄ Page Routerμ κΈ°λ¥μ„ ν™•μ¥ν•μ—¬, ν΄λ” κΈ°λ°μ νμΌ κµ¬μ΅°λ§μΌλ΅ λ”μ± μ§κ΄€μ μΈ λΌμ°ν…κ³Ό μ„λ²„ μ»΄ν¬λ„νΈ κΈ°λ¥μ„ μ§€μ›ν•λ‹¤.

### π“ νμ΄μ§€ λΌμ°ν… μ„¤μ •

- `/` : `app/` ν΄λ” λ‚΄μ— **page.tsx** νμΌ μ‘μ„± β†’ λ£¨νΈ κ²½λ΅λ΅ μ„¤μ •λ¨
- `/search` : `app/search/page.tsx` μƒμ„± β†’ `/search` κ²½λ΅λ΅ λΌμ°ν…
- `/book/1` : `app/book/[id]/page.tsx` μƒμ„± β†’ λ™μ  λΌμ°ν… μ„¤μ •, URL νλΌλ―Έν„° μ‚¬μ© κ°€λ¥

### π” URL μΏΌλ¦¬ & νλΌλ―Έν„° λ°›μ•„μ¤κΈ°

#### β”οΈ μΏΌλ¦¬ νλΌλ―Έν„° (`searchParams`)

```tsx
export default async function Page({
  searchParams,
}: {
  searchParams: Promise<{ q: string }>;
}) {
  const { q } = await searchParams;
  // ...
}
```

#### β”οΈ URL νλΌλ―Έν„° (`params`)

```tsx
export default async function Page({
  params,
}: {
  params: Promise<{ id: string }>;
}) {
  const { id } = await params;
  // ...
}
```

### π—‚ Layout.tsx

- ν„μ¬ ν΄λ” λ° **ν•μ„ ν΄λ”**μ— μ μ©λλ” κ³µν†µ λ μ΄μ•„μ›ƒ νμΌ
- μ¤‘μ²© μ‚¬μ© κ°€λ¥ν•μ—¬ λ μ΄μ•„μ›ƒμ„ κ³„μΈµμ μΌλ΅ κµ¬μ„±ν•  μ μμ

### π“¦ Route Group

- `()`λ΅ κ°μ‹Έμ§„ ν΄λ”λ… β†’ **URL κ²½λ΅μ—λ” λ‚νƒ€λ‚μ§€ μ•μ**
- μ) νΉμ • layoutλ§ μ μ©ν•κ±°λ‚ κ·Έλ£Ήν•‘ν•  λ• ν™μ©

## β΅οΈ React Server Component

![server](https://github.com/user-attachments/assets/506859a9-c4e1-48d3-9fae-9709e532aa08)

### β”οΈ κ°λ…

- **μƒνΈμ‘μ©μ΄ ν•„μ” μ—†λ” μ»΄ν¬λ„νΈ**λ¥Ό μ„λ²„μ—μ„ λ λ”λ§ν•λ” λ°©μ‹
- μ„λ²„ μΈ΅μ—μ„ μ‚¬μ „ λ λ”λ§μ„ μ§„ν–‰ν•λ―€λ΅, ν΄λΌμ΄μ–ΈνΈ λ²λ“¤(JS Bundle)μ—λ” ν¬ν•¨λμ§€ μ•μ•„ μ„±λ¥ μµμ ν™” κ°€λ¥

### β”οΈ μ‘λ™ μ›λ¦¬

- μ„λ²„ μ»΄ν¬λ„νΈ: μ‚¬μ „ λ λ”λ§ μ‹ ν• λ²λ§ μ‹¤ν–‰
- ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ: μ„λ²„ + ν΄λΌμ΄μ–ΈνΈ λ¨λ‘μ—μ„ μ‹¤ν–‰λμ–΄ hydrationμ΄ ν•„μ”ν•¨
- κΈ°λ³Έμ μΌλ΅ App Routerμ μ»΄ν¬λ„νΈλ” **Server Component**λ΅ μ„¤μ •λ¨

#### ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ μ „ν™ν•κΈ°

```tsx
"use client";
```

- νμΌ μµμƒλ‹¨μ— μ„ μ–Έν•λ©΄ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ™μ‘

### β οΈ React Server Component μ£Όμμ‚¬ν•­

1. μ„λ²„ μ»΄ν¬λ„νΈμ—λ” **λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λλ” μ½”λ“** ν¬ν•¨ λ¶κ°€
2. ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ λ¨λ‘μ—μ„ μ‹¤ν–‰λ¨
3. ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ β†’ μ„λ²„ μ»΄ν¬λ„νΈ import λ¶κ°€ (λ°λ€λ” κ°€λ¥)
4. μ„λ²„ μ»΄ν¬λ„νΈ β†’ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ **ν•¨μ props μ „λ‹¬ λ¶κ°€** (μ§λ ¬ν™” λ¶κ°€λ¥)

## π€ λ„¤λΉ„κ²μ΄μ…κ³Ό fetch μµμ…

### β”οΈ useRouter & useSearchParams

- **next/navigation**μ—μ„ import
- App Router μ „μ© ν›…

### β”οΈ .env λ³€μ μ‚¬μ©

- ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ λ‚΄μ—μ„ μ‚¬μ© μ‹, λ³€μλ… μ•μ— **NEXT_PUBLIC\_** prefix ν•„μ”

### β”οΈ fetch μµμ…

| μµμ…                          | μ„¤λ…                                             |
| ----------------------------- | ------------------------------------------------ |
| `{ cache: "force-cache" }`    | μ”μ²­ κ²°κ³Όλ¥Ό λ¬΄μ΅°κ±΄ μΊμ‹±, μ΄ν›„ λ‹¤μ‹ νΈμ¶λμ§€ μ•μ |
| `{ cache: "no-store" }`       | μΊμ‹± μ—†μ΄ λ§¤λ² μƒλ΅ μ”μ²­ (**κΈ°λ³Έκ°’**)            |
| `{ next: { revalidate: n } }` | nμ΄ λ’¤ μΊμ‹ λ¬΄ν¨ν™” ν›„ μ¬μ”μ²­ (ISR λ°©μ‹)          |
| `{ next: { tags: ["a"] } }`   | On-Demand Revalidate μ‹ λ°μ΄ν„° μµμ‹ ν™”            |

### π§  Request Memoization

- λ λ”λ§ μ¤‘ **κ°™μ€ μ”μ²­**μ΄ μ—¬λ¬ λ² λ°μƒν•λ©΄ κ²°κ³Όλ¥Ό λ©”λ¨μ΄μ μ΄μ…ν•μ—¬ μ¤‘λ³µ μ”μ²­ λ°©μ§€
- λ λ”λ§μ΄ λλ‚λ©΄ λ©”λ¨μ΄μ μ΄μ…λ„ μ†λ©Έλ¨

## π—ƒ Full Route Cache (SSGμ™€ μ μ‚¬)

### β”οΈ κ°λ…

- λΉλ“ νƒ€μ„μ— νμ΄μ§€λ¥Ό μ •μ μΌλ΅ μƒμ„±ν•μ—¬ μΊμ‹μ— μ €μ¥
- μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ μΊμ‹μ—μ„ λ°”λ΅ λ λ”λ§ (λΉ λ¥Έ μ‘λ‹µ μ†λ„)
- `revalidate: n` μµμ…μ΄ μμΌλ©΄ nμ΄ ν›„ μΊμ‹ λ¬΄ν¨ν™” (ISR λ°©μ‹)

### β”οΈ νμ΄μ§€ μ ν•

| μ ν•             | μ„¤λ…                                                        |
| ---------------- | ----------------------------------------------------------- |
| **Dynamic Page** | λ°μ΄ν„°κ°€ λ§¤λ² λ³€ν•κ±°λ‚ cache: "no-store" μµμ…μ„ κ°€μ§„ νμ΄μ§€ |
| **Static Page**  | Dynamic Pageκ°€ μ•„λ‹ μ •μ  νμ΄μ§€                             |

![page](https://github.com/user-attachments/assets/6226f1a4-34d1-491e-9999-a7e519ca5faf)


### β³ Suspenseλ΅ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ‚¬μ „ λ λ”λ§ λ°°μ ν•κΈ°

```tsx
<Suspense fallback={<div>loading...</div>}>
  <ClientComponent />
</Suspense>
```

### π›  generateStaticParams()

- λ™μ  νμ΄μ§€λ¥Ό λΉλ“ νƒ€μ„μ— μƒμ„±ν•  λ• μ‚¬μ©
- μ μ©λ κ°’ μ΄μ™Έμ κ²½μ°λ” μ—†λ‹¤κ³  κ°€μ •ν•λ ¤λ©΄:

```tsx
export const dynamicParams = false;
```

### β… μ”μ•½

- App Routerλ” **ν΄λ” κΈ°λ°μ μ§κ΄€μ μΈ λΌμ°ν… + Server Component μ¤‘μ‹¬ λ λ”λ§**
- ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” κΌ­ ν•„μ”ν• μƒνΈμ‘μ© λ¶€λ¶„μ—λ§ μµμ†ν™”ν•μ—¬ μ‚¬μ©ν•κΈ°
- fetch, caching, λ„¤λΉ„κ²μ΄μ… ν›…μ λ™μ‘ λ°©μ‹μ„ μ •ν™•ν μ΄ν•΄ν•΄λ‘μ!
